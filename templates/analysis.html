<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analysis - NASA Urban Analytics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --nasa-blue: #0b3d91;
            --nasa-light-blue: #1a6bc7;
            --nasa-dark-blue: #06255e;
            --nasa-accent: #ffd700;
        }
        
        .nav-gradient {
            background: linear-gradient(135deg, var(--nasa-dark-blue), var(--nasa-blue)) !important;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--nasa-blue), var(--nasa-light-blue)) !important;
            color: white;
            border-radius: 15px 15px 0 0 !important;
            border: none;
            padding: 1.5rem;
        }
        
        .table th {
            background-color: var(--nasa-blue);
            color: white;
        }
        
        .section-title {
            color: var(--nasa-blue);
            font-weight: 700;
            margin-bottom: 2rem;
            border-bottom: 3px solid var(--nasa-accent);
            padding-bottom: 10px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, var(--nasa-blue), var(--nasa-light-blue));
            color: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(11, 61, 145, 0.3);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .alert-nasa {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border: 1px solid var(--nasa-light-blue);
            border-radius: 10px;
            color: var(--nasa-dark-blue);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark nav-gradient">
        <div class="container">
            <a class="navbar-brand fw-bold" href="/">
                <i class="fas fa-satellite me-2"></i>
                NASA Urban Analytics
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">Home</a>
                <a class="nav-link" href="/dashboard">Dashboard</a>
                <a class="nav-link" href="/heatmaps">Heat Maps</a>
                <a class="nav-link" href="/satellite">Satellite Data</a>
                <a class="nav-link active" href="/analysis">Analysis</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid py-5 mt-4">
        <div class="container">
            <h1 class="section-title">Detailed Technical Analysis</h1>
            <p class="lead mb-5">Comprehensive breakdown of urban sustainability metrics across Bhopal using NASA satellite data.</p>

            <!-- Data Table -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-table me-2"></i>Complete Dataset
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Area</th>
                                    <th>Transport</th>
                                    <th>Pollution</th>
                                    <th>Energy</th>
                                    <th>Solar Potential</th>
                                    <th>Capacity</th>
                                    <th>Sustainability Score</th>
                                    <th>Population</th>
                                    <th>Green Cover</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for area, area_data in data.items() %}
                                <tr>
                                    <td><strong>{{ area_data.name }}</strong></td>
                                    <td>
                                        <span class="badge 
                                            {% if area_data.transport_index >= 70 %}bg-success
                                            {% elif area_data.transport_index >= 50 %}bg-warning
                                            {% else %}bg-danger{% endif %}">
                                            {{ "%.1f"|format(area_data.transport_index) }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="badge 
                                            {% if area_data.pollution_index <= 30 %}bg-success
                                            {% elif area_data.pollution_index <= 60 %}bg-warning
                                            {% else %}bg-danger{% endif %}">
                                            {{ "%.1f"|format(area_data.pollution_index) }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="badge 
                                            {% if area_data.energy_index >= 70 %}bg-success
                                            {% elif area_data.energy_index >= 50 %}bg-warning
                                            {% else %}bg-danger{% endif %}">
                                            {{ "%.1f"|format(area_data.energy_index) }}
                                        </span>
                                    </td>
                                    <td>{{ "%.1f"|format(area_data.solar_potential) }} kWh/mÂ²/day</td>
                                    <td>
                                        <span class="badge 
                                            {% if area_data.renewable_capacity in ['Excellent','Very High'] %}bg-success
                                            {% elif area_data.renewable_capacity == 'High' %}bg-info
                                            {% elif area_data.renewable_capacity == 'Medium' %}bg-warning
                                            {% else %}bg-danger{% endif %}">
                                            {{ area_data.renewable_capacity }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="badge 
                                            {% if area_data.sustainability_score >= 70 %}bg-success
                                            {% elif area_data.sustainability_score >= 50 %}bg-warning
                                            {% else %}bg-danger{% endif %}">
                                            {{ "%.1f"|format(area_data.sustainability_score) }}
                                        </span>
                                    </td>
                                    <td>{{ area_data.population_density }}</td>
                                    <td>{{ area_data.green_cover }}%</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Methodology & Data Sources -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-calculator me-2"></i>Methodology
                            </h5>
                        </div>
                        <div class="card-body">
                            <h6 class="text-nasa-blue">Transport Index Calculation</h6>
                            <ul>
                                <li>Public Transport Availability: 40% weight</li>
                                <li>Walking & Cycling Infrastructure: 30% weight</li>
                                <li>Private Vehicle Usage (inverse): 30% weight</li>
                            </ul>

                            <h6 class="text-nasa-blue">Pollution Index Calculation</h6>
                            <ul>
                                <li>PM2.5 Levels: 30% weight</li>
                                <li>PM10 Levels: 30% weight</li>
                                <li>NO2 Concentration: 20% weight</li>
                                <li>SO2 Concentration: 20% weight</li>
                            </ul>

                            <h6 class="text-nasa-blue">Energy Index Calculation</h6>
                            <ul>
                                <li>Solar Energy Usage: 40% weight</li>
                                <li>Battery Storage: 30% weight</li>
                                <li>Grid Dependency (inverse): 30% weight</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-database me-2"></i>Data Sources
                            </h5>
                        </div>
                        <div class="card-body">
                            <h6 class="text-nasa-blue">NASA APIs Used</h6>
                            <ul>
                                <li>POWER API - Solar radiation data</li>
                                <li>MODIS - Vegetation and temperature data</li>
                                <li>Landsat - High-resolution urban analysis</li>
                                <li>Simulated Air Quality Models</li>
                            </ul>

                            <h6 class="text-nasa-blue">Local Data Sources</h6>
                            <ul>
                                <li>Bhopal Municipal Corporation</li>
                                <li>Transport Department Data</li>
                                <li>Census Population Data</li>
                                <li>Urban Development Reports</li>
                            </ul>

                            <div class="alert alert-nasa mt-3">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Note:</strong> Some data is simulated when NASA APIs are rate-limited. All simulated data is based on realistic Bhopal urban characteristics.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Metrics Summary -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-chart-bar me-2"></i>Key Metrics Summary
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-md-3 mb-3">
                                    <div class="stat-card">
                                        <div class="stat-number">
                                            {{ data.values()|map(attribute='transport_index')|list|sum / data.values()|length|round(1) }}
                                        </div>
                                        <div>Avg Transport Index</div>
                                    </div>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <div class="stat-card">
                                        <div class="stat-number">
                                            {{ data.values()|map(attribute='pollution_index')|list|sum / data.values()|length|round(1) }}
                                        </div>
                                        <div>Avg Pollution Index</div>
                                    </div>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <div class="stat-card">
                                        <div class="stat-number">
                                            {{ data.values()|map(attribute='energy_index')|list|sum / data.values()|length|round(1) }}
                                        </div>
                                        <div>Avg Energy Index</div>
                                    </div>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <div class="stat-card">
                                        <div class="stat-number">
                                            {{ data.values()|map(attribute='sustainability_score')|list|sum / data.values()|length|round(1) }}
                                        </div>
                                        <div>Avg Sustainability</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>