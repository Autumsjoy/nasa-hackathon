<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhopal Urban Planning Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <div class="header">
            <h1>üåç Bhopal Urban Planning Dashboard</h1>
            <p>AI-powered analysis of urban areas and environmental concerns in Bhopal</p>
            <div class="city-info">
                <span>üèôÔ∏è Population: {{ bhopal_data.population }}</span>
                <span>üìè Area: {{ bhopal_data.area }}</span>
                <span>üå°Ô∏è Temperature: {{ bhopal_data.temperature_range }}</span>
            </div>
        </div>

        <!-- Map Section -->
        <div class="card map-section">
            <h2>üó∫Ô∏è Bhopal Urban Areas Analysis</h2>
            <div id="bhopal-map" class="bhopal-map"></div>
            <div class="map-legend">
                <div class="legend-item"><span class="legend-color residential"></span> Residential</div>
                <div class="legend-item"><span class="legend-color commercial"></span> Commercial</div>
                <div class="legend-item"><span class="legend-color industrial"></span> Industrial</div>
                <div class="legend-item"><span class="legend-color green_space"></span> Green Space</div>
                <div class="legend-item"><span class="legend-color mixed_use"></span> Mixed Use</div>
            </div>
        </div>

        <!-- Urban Areas Analysis -->
        <div class="card urban-areas">
            <h2>üèòÔ∏è Urban Areas of Bhopal</h2>
            <div class="areas-grid">
                {% for area in bhopal_data.urban_areas %}
                <div class="area-card" data-area="{{ area.name }}" onclick="analyzeArea('{{ area.name }}')">
                    <div class="area-header" style="border-left-color: {{ area.color }};">
                        <h3>{{ area.name }}</h3>
                        <span class="area-type">{{ area.type | replace('_', ' ') | title }}</span>
                    </div>
                    <div class="area-stats">
                        <div class="stat">
                            <span class="label">Temperature:</span>
                            <span class="value">{{ area.temperature }}¬∞C</span>
                        </div>
                        <div class="stat">
                            <span class="label">Population Density:</span>
                            <span class="value">{{ area.population_density }}/km¬≤</span>
                        </div>
                        <div class="stat">
                            <span class="label">Green Cover:</span>
                            <span class="value">{{ (area.vegetation * 100) | round(1) }}%</span>
                        </div>
                    </div>
                    <div class="area-concerns">
                        <strong>Key Concerns:</strong>
                        <ul>
                            {% for concern in area.concerns %}
                            <li>{{ concern }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Analysis Results -->
        <div class="card analysis-results">
            <h2>üìä Area Analysis Results</h2>
            <div id="results-container">
                <div class="placeholder">
                    <p>Click on any urban area card to see detailed analysis and predictions</p>
                </div>
                <div id="analysis-results" class="hidden">
                    <div class="temperature-display">
                        <h3 id="predicted-temp">--¬∞C</h3>
                        <p id="temp-interpretation"></p>
                    </div>
                    <div class="health-score">
                        <h4>Urban Health Score: <span id="health-score">--</span>/100</h4>
                        <p>Risk Level: <span id="risk-level" class="risk-low">--</span></p>
                    </div>
                    <div class="recommendations">
                        <h4>üí° Recommendations</h4>
                        <div id="recommendations-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Major Problems -->
        <div class="card major-problems">
            <h2>‚ö†Ô∏è Major Urban Problems in Bhopal</h2>
            <div class="problems-list">
                {% for problem in bhopal_data.major_problems %}
                <div class="problem-card severity-{{ problem.severity }}">
                    <div class="problem-header">
                        <h3>{{ problem.problem }}</h3>
                        <span class="severity-badge">{{ problem.severity | upper }}</span>
                    </div>
                    <p class="problem-desc">{{ problem.description }}</p>
                    <div class="problem-impact">
                        <strong>Impact:</strong> {{ problem.impact }}
                    </div>
                    <div class="solutions">
                        <strong>Suggested Solutions:</strong>
                        <ul>
                            {% for solution in problem.solutions %}
                            <li>{{ solution }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Heat Map Visualization -->
        <div class="card heat-map">
            <h2>üî• Bhopal Heat Map Analysis</h2>
            <div class="heat-map-container">
                <div class="heat-map-visual">
                    {% for point in bhopal_data.heatmap_data %}
                    <div class="heat-point" 
                         style="left: {{ (point.lng - 77.38) * 500 }}px; 
                                top: {{ (23.28 - point.lat) * 500 }}px;
                                width: {{ point.intensity * 30 }}px;
                                height: {{ point.intensity * 30 }}px;
                                background: rgba(255, {{ 255 - point.intensity * 200 }}, 0, 0.7);">
                        <span class="heat-tooltip">{{ point.type }}: {{ point.temperature }}¬∞C</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="heat-legend">
                <span>Cool</span>
                <div class="gradient-bar"></div>
                <span>Hot</span>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>