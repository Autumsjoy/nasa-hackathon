<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ area_name }} - Detailed Analysis | NASA Hackathon 2025</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #50589C;
            --primary-light: #6A72B0;
            --primary-dark: #404780;
            --secondary-color: #FF6B35;
            --accent-color: #4ECDC4;
            --dark-color: #2C3E50;
            --light-color: #F8F9FA;
            --success-color: #27AE60;
            --warning-color: #E67E22;
            --danger-color: #E74C3C;
            --info-color: #3498DB;
        }
        
        body {
            background-color: var(--light-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .analysis-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            padding: 40px 0;
            margin-bottom: 30px;
        }
        
        .metric-card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(80, 88, 156, 0.15);
            margin-bottom: 25px;
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary-color);
        }
        
        .metric-card.critical {
            border-left: 4px solid var(--danger-color);
            animation: pulse-warning 2s infinite;
        }
        
        @keyframes pulse-warning {
            0% { box-shadow: 0 0 0 0 rgba(229, 83, 75, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(229, 83, 75, 0); }
            100% { box-shadow: 0 0 0 0 rgba(229, 83, 75, 0); }
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(80, 88, 156, 0.25);
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .metric-value.critical {
            color: var(--danger-color);
        }
        
        .metric-value.warning {
            color: var(--warning-color);
        }
        
        .metric-value.good {
            color: var(--success-color);
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid rgba(80, 88, 156, 0.1);
        }
        
        .btn-solution {
            background: linear-gradient(135deg, var(--secondary-color), #FF8C42);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }
        
        .btn-solution:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
        }
        
        .solution-modal {
            border-radius: 15px;
        }
        
        .solution-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            border-radius: 15px 15px 0 0;
        }
        
        .timeline {
            position: relative;
            padding-left: 30px;
            margin: 20px 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary-color);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -36px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary-color);
            border: 3px solid white;
        }
        
        .report-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--accent-color);
        }
        
        .impact-card {
            border-left: 4px solid;
            transition: all 0.3s ease;
        }
        
        .impact-card.health { border-left-color: #E74C3C; }
        .impact-card.economic { border-left-color: #F39C12; }
        .impact-card.environment { border-left-color: #27AE60; }
        .impact-card.social { border-left-color: #3498DB; }
        
        .critical-alert {
            border-left: 6px solid var(--danger-color);
            background: linear-gradient(135deg, #fff, #ffeaea);
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .sector-impact {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .impact-meter {
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .impact-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease-in-out;
        }
        
        .impact-high { background: linear-gradient(135deg, #E74C3C, #C0392B); }
        .impact-medium { background: linear-gradient(135deg, #F39C12, #E67E22); }
        .impact-low { background: linear-gradient(135deg, #27AE60, #2ECC71); }
        
        .career-graph {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="{{ url_for('index') }}" style="color: var(--primary-color);">
                <i class="fas fa-satellite me-2"></i>NASA Urban Planning
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="navbar-nav ms-auto">
                    <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                    <a class="nav-link" href="{{ url_for('dashboard') }}">Dashboard</a>
                    <a class="nav-link active" href="{{ url_for('analysis_page') }}">Analysis</a>
                    <a class="nav-link" href="{{ url_for('satellite') }}">Satellite</a>
                    <a class="nav-link" href="{{ url_for('heatmaps') }}">Heat Maps</a>
                    <a class="nav-link" href="{{ url_for('satellite_3d') }}">3D Map</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <div class="analysis-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold">{{ area_name }}</h1>
                    <p class="lead mb-0">{{ area_description }}</p>
                    <small>Area Type: {{ area_type }} | Population Density: {{ area_data.population_density }}/kmÂ²</small>
                </div>
                <div class="col-md-4 text-end">
                    <div class="card">
                        <div class="card-body">
                            <select id="areaSelector" onchange="navigateToArea(this.value)" class="form-select">
                                <option value="">Select Area...</option>
                                {% for key, info in area_mappings.items() %}
                                <option value="{{ key }}" {% if key == area_key %}selected{% endif %}>
                                    {{ info.name }}
                                </option>
                                {% endfor %}
                            </select>
                            <div class="mt-2 text-center">
                                <span class="badge bg-{% if area_data.sustainability_score >= 70 %}success{% elif area_data.sustainability_score >= 50 %}warning{% else %}danger{% endif %}">
                                    Overall Score: {{ "%.1f"|format(area_data.sustainability_score) }}/100
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Critical Alerts Section -->
        {% set critical_issues = [] %}
        {% if area_data.pollution_index > 7 %}{% set _ = critical_issues.append('pollution') %}{% endif %}
        {% if area_data.temperature > 33 %}{% set _ = critical_issues.append('temperature') %}{% endif %}
        {% if area_data.sustainability_score < 30 %}{% set _ = critical_issues.append('sustainability') %}{% endif %}
        {% if area_data.transport_index < 4 %}{% set _ = critical_issues.append('transport') %}{% endif %}
        {% if area_data.energy_index < 4 %}{% set _ = critical_issues.append('energy') %}{% endif %}
        
        {% if critical_issues %}
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert critical-alert">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-exclamation-triangle fa-2x text-danger me-3"></i>
                        <div>
                            <h5 class="alert-heading mb-1">ð¨ CRITICAL ALERT: Immediate Attention Required</h5>
                            <p class="mb-0">This area has <strong>{{ critical_issues|length }} critical issue(s)</strong> requiring immediate intervention:</p>
                            <ul class="mb-0 mt-2">
                                {% for issue in critical_issues %}
                                <li><strong>{{ issue|title }}</strong> levels are at dangerous thresholds</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Quick Stats with Solution Buttons -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card metric-card {% if area_data.sustainability_score < 30 %}critical{% endif %}">
                    <div class="card-body text-center">
                        <div class="d-flex justify-content-between align-items-start">
                            <h5 class="card-title text-muted">Sustainability Score</h5>
                            <button class="btn-solution" data-bs-toggle="modal" data-bs-target="#sustainabilityModal">
                                <i class="fas fa-lightbulb me-1"></i>Solutions
                            </button>
                        </div>
                        <div class="metric-value {% if area_data.sustainability_score < 30 %}critical{% elif area_data.sustainability_score < 50 %}warning{% else %}good{% endif %}">
                            {{ "%.1f"|format(area_data.sustainability_score) }}
                        </div>
                        <small class="text-muted">Overall Rating /100</small>
                        <div class="progress mt-2">
                            <div class="progress-bar {% if area_data.sustainability_score < 30 %}bg-danger{% elif area_data.sustainability_score < 50 %}bg-warning{% else %}bg-success{% endif %}" 
                                 style="width: {{ area_data.sustainability_score }}%"></div>
                        </div>
                        {% if area_data.sustainability_score < 30 %}
                        <small class="text-danger mt-1"><i class="fas fa-exclamation-circle"></i> Critical Level</small>
                        {% elif area_data.sustainability_score < 50 %}
                        <small class="text-warning mt-1"><i class="fas fa-exclamation-triangle"></i> Needs Improvement</small>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card {% if area_data.transport_index < 4 %}critical{% endif %}">
                    <div class="card-body text-center">
                        <div class="d-flex justify-content-between align-items-start">
                            <h5 class="card-title text-muted">Transport Efficiency</h5>
                            <button class="btn-solution" data-bs-toggle="modal" data-bs-target="#transportModal">
                                <i class="fas fa-lightbulb me-1"></i>Solutions
                            </button>
                        </div>
                        <div class="metric-value {% if area_data.transport_index < 4 %}critical{% elif area_data.transport_index < 6 %}warning{% else %}good{% endif %}">
                            {{ "%.1f"|format(area_data.transport_index) }}
                        </div>
                        <small class="text-muted">Performance Index /10</small>
                        <div class="progress mt-2">
                            <div class="progress-bar {% if area_data.transport_index < 4 %}bg-danger{% elif area_data.transport_index < 6 %}bg-warning{% else %}bg-success{% endif %}" 
                                 style="width: {{ area_data.transport_index * 10 }}%"></div>
                        </div>
                        {% if area_data.transport_index < 4 %}
                        <small class="text-danger mt-1"><i class="fas fa-exclamation-circle"></i> Critical Infrastructure</small>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card {% if area_data.energy_index < 4 %}critical{% endif %}">
                    <div class="card-body text-center">
                        <div class="d-flex justify-content-between align-items-start">
                            <h5 class="card-title text-muted">Energy Performance</h5>
                            <button class="btn-solution" data-bs-toggle="modal" data-bs-target="#energyModal">
                                <i class="fas fa-lightbulb me-1"></i>Solutions
                            </button>
                        </div>
                        <div class="metric-value {% if area_data.energy_index < 4 %}critical{% elif area_data.energy_index < 6 %}warning{% else %}good{% endif %}">
                            {{ "%.1f"|format(area_data.energy_index) }}
                        </div>
                        <small class="text-muted">Efficiency Index /10</small>
                        <div class="progress mt-2">
                            <div class="progress-bar {% if area_data.energy_index < 4 %}bg-danger{% elif area_data.energy_index < 6 %}bg-warning{% else %}bg-success{% endif %}" 
                                 style="width: {{ area_data.energy_index * 10 }}%"></div>
                        </div>
                        {% if area_data.energy_index < 4 %}
                        <small class="text-danger mt-1"><i class="fas fa-exclamation-circle"></i> Energy Crisis Risk</small>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card {% if area_data.pollution_index > 7 %}critical{% endif %}">
                    <div class="card-body text-center">
                        <div class="d-flex justify-content-between align-items-start">
                            <h5 class="card-title text-muted">Environmental Quality</h5>
                            <button class="btn-solution" data-bs-toggle="modal" data-bs-target="#environmentModal">
                                <i class="fas fa-lightbulb me-1"></i>Solutions
                            </button>
                        </div>
                        <div class="metric-value {% if area_data.pollution_index > 7 %}critical{% elif area_data.pollution_index > 5 %}warning{% else %}good{% endif %}">
                            {{ "%.1f"|format(10 - area_data.pollution_index) }}
                        </div>
                        <small class="text-muted">Pollution Control /10</small>
                        <div class="progress mt-2">
                            <div class="progress-bar {% if area_data.pollution_index > 7 %}bg-danger{% elif area_data.pollution_index > 5 %}bg-warning{% else %}bg-success{% endif %}" 
                                 style="width: {{ (10 - area_data.pollution_index) * 10 }}%"></div>
                        </div>
                        {% if area_data.pollution_index > 7 %}
                        <small class="text-danger mt-1"><i class="fas fa-exclamation-circle"></i> Health Hazard</small>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Future Impact Report Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="chart-container">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 style="color: var(--primary-color);">
                            <i class="fas fa-chart-line me-2"></i>5-Year Sustainability Report & Future Projections
                        </h4>
                        <button class="btn btn-primary" onclick="generateReport()">
                            <i class="fas fa-download me-2"></i>Generate Executive Report
                        </button>
                    </div>
                    
                    <!-- Historical Trends -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="report-card">
                                <h5>ð Sustainability Score Trend</h5>
                                <canvas id="sustainabilityTrendChart" height="200"></canvas>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="report-card">
                                <h5>ð¡ï¸ Environmental Metrics Trend</h5>
                                <canvas id="environmentTrendChart" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Future Impact Analysis -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="report-card">
                                <h5>â ï¸ Future Impact Analysis: 1-Year Projection</h5>
                                <p class="text-muted">Projected consequences if current conditions persist for 12 months</p>
                                
                                <div class="row">
                                    <!-- Health Impacts -->
                                    <div class="col-md-6 mb-3">
                                        <div class="impact-card health">
                                            <div class="card-body">
                                                <h6><i class="fas fa-heartbeat text-danger me-2"></i>Health Impacts</h6>
                                                <div class="impact-meter">
                                                    <div class="impact-fill impact-high" style="width: 85%"></div>
                                                </div>
                                                <ul class="small">
                                                    <li>15-20% increase in respiratory diseases</li>
                                                    <li>10% rise in heat-related illnesses</li>
                                                    <li>5-8% increase in cardiovascular issues</li>
                                                    <li>Mental health impacts from environmental stress</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Economic Impacts -->
                                    <div class="col-md-6 mb-3">
                                        <div class="impact-card economic">
                                            <div class="card-body">
                                                <h6><i class="fas fa-chart-line text-warning me-2"></i>Economic Impacts</h6>
                                                <div class="impact-meter">
                                                    <div class="impact-fill impact-medium" style="width: 70%"></div>
                                                </div>
                                                <ul class="small">
                                                    <li>12-18% productivity loss due to heat stress</li>
                                                    <li>Increased healthcare costs: $2-3M annually</li>
                                                    <li>Property value depreciation in affected zones</li>
                                                    <li>Tourism revenue decline: 15-25%</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Environmental Impacts -->
                                    <div class="col-md-6 mb-3">
                                        <div class="impact-card environment">
                                            <div class="card-body">
                                                <h6><i class="fas fa-tree text-success me-2"></i>Environmental Impacts</h6>
                                                <div class="impact-meter">
                                                    <div class="impact-fill impact-high" style="width: 80%"></div>
                                                </div>
                                                <ul class="small">
                                                    <li>5-8% vegetation cover loss</li>
                                                    <li>Increased soil erosion and degradation</li>
                                                    <li>Biodiversity reduction: 10-15% species impact</li>
                                                    <li>Water quality deterioration</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Social Impacts -->
                                    <div class="col-md-6 mb-3">
                                        <div class="impact-card social">
                                            <div class="card-body">
                                                <h6><i class="fas fa-users text-info me-2"></i>Social Impacts</h6>
                                                <div class="impact-meter">
                                                    <div class="impact-fill impact-medium" style="width: 65%"></div>
                                                </div>
                                                <ul class="small">
                                                    <li>Increased social inequality in affected areas</li>
                                                    <li>15-20% reduction in outdoor activities</li>
                                                    <li>Community displacement risk</li>
                                                    <li>Educational disruptions</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Career Graph for Problems -->
                    <div class="row">
                        <div class="col-12">
                            <div class="report-card">
                                <h5>ð Problem Escalation Timeline</h5>
                                <p class="text-muted">Projected career path of current issues if left unaddressed</p>
                                <div class="career-graph">
                                    <canvas id="problemCareerChart" height="150"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Yearly Breakdown -->
                    <div class="row">
                        <div class="col-12">
                            <div class="report-card">
                                <h5>ð Year-by-Year Performance Analysis</h5>
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Year</th>
                                                <th>Sustainability Score</th>
                                                <th>Transport Efficiency</th>
                                                <th>Energy Performance</th>
                                                <th>Environmental Quality</th>
                                                <th>Key Events</th>
                                                <th>Improvement</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for year in range(2020, 2026) %}
                                            <tr>
                                                <td><strong>{{ year }}</strong></td>
                                                <td>
                                                    {% set score = area_data.sustainability_score + (year - 2020) * 3.5 %}
                                                    <span class="badge bg-{% if score >= 70 %}success{% elif score >= 50 %}warning{% else %}danger{% endif %}">
                                                        {{ "%.1f"|format(score) }}
                                                    </span>
                                                </td>
                                                <td>
                                                    {% set transport = area_data.transport_index + (year - 2020) * 0.4 %}
                                                    {{ "%.1f"|format(transport) }}/10
                                                </td>
                                                <td>
                                                    {% set energy = area_data.energy_index + (year - 2020) * 0.3 %}
                                                    {{ "%.1f"|format(energy) }}/10
                                                </td>
                                                <td>
                                                    {% set env = (10 - area_data.pollution_index) + (year - 2020) * 0.5 %}
                                                    {{ "%.1f"|format(env) }}/10
                                                </td>
                                                <td>
                                                    {% if year == 2020 %}
                                                    <span class="badge bg-secondary">Baseline</span>
                                                    {% elif year == 2021 %}
                                                    <span class="badge bg-info">Green Initiative</span>
                                                    {% elif year == 2022 %}
                                                    <span class="badge bg-success">Transport Upgrade</span>
                                                    {% elif year == 2023 %}
                                                    <span class="badge bg-warning">Energy Focus</span>
                                                    {% elif year == 2024 %}
                                                    <span class="badge bg-primary">Smart City</span>
                                                    {% else %}
                                                    <span class="badge bg-success">Current</span>
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    {% set improvement = (year - 2020) * 3.5 %}
                                                    <span class="text-success">+{{ "%.1f"|format(improvement) }}%</span>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Executive Summary for High-Level Personnel -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="chart-container">
                    <h4 style="color: var(--primary-color);">
                        <i class="fas fa-file-alt me-2"></i>Executive Impact Summary
                    </h4>
                    <div class="alert alert-warning">
                        <h6>ð KEY TAKEAWAYS FOR DECISION MAKERS:</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="mb-0">
                                    <li><strong>Immediate Health Crisis:</strong> Current pollution levels pose immediate public health risks</li>
                                    <li><strong>Economic Vulnerability:</strong> Infrastructure gaps threaten economic stability</li>
                                    <li><strong>Environmental Degradation:</strong> Accelerated ecosystem decline observed</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="mb-0">
                                    <li><strong>Social Equity Concerns:</strong> Disproportionate impact on vulnerable populations</li>
                                    <li><strong>Infrastructure Stress:</strong> Systems operating beyond design capacity</li>
                                    <li><strong>Climate Resilience Deficit:</strong> Limited adaptive capacity for future challenges</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row text-center">
                        <div class="col-md-3">
                            <div class="p-3">
                                <div class="h2 text-danger mb-2">â¹85Cr+</div>
                                <small>Annual Economic Impact</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="p-3">
                                <div class="h2 text-warning mb-2">25K+</div>
                                <small>People at Health Risk</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="p-3">
                                <div class="h2 text-info mb-2">15%</div>
                                <small>Productivity Loss</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="p-3">
                                <div class="h2 text-success mb-2">â¹45Cr</div>
                                <small>Potential Annual Savings</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Analysis Content -->
        <div class="row">
            <div class="col-12">
                <div class="chart-container">
                    <h4 style="color: var(--primary-color);">
                        <i class="fas fa-chart-bar me-2"></i>Performance Indicators
                    </h4>
                    {% if performance_indicators %}
                        {{ performance_indicators|safe }}
                    {% else %}
                        <div class="alert alert-warning">Performance indicators not available</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Solution Modals (Keep existing modals) -->
    <!-- ... existing modals code ... -->

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        function navigateToArea(areaKey) {
            if (areaKey) {
                window.location.href = `/analysis/${areaKey}`;
            }
        }

        function generateReport() {
            // Simulate report generation
            alert('ð Generating comprehensive executive impact report...\n\nThis report will include:\nâ¢ Future impact projections\nâ¢ Economic cost analysis\nâ¢ Health risk assessments\nâ¢ Infrastructure vulnerability analysis\nâ¢ Strategic recommendations\n\nThe report will be downloaded as PDF.');
            
            // In a real implementation, this would generate and download a PDF
            setTimeout(() => {
                alert('â Executive report generated successfully! Check your downloads folder.');
            }, 2000);
        }

        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Sustainability Trend Chart
            const sustainabilityCtx = document.getElementById('sustainabilityTrendChart').getContext('2d');
            new Chart(sustainabilityCtx, {
                type: 'line',
                data: {
                    labels: ['2020', '2021', '2022', '2023', '2024', '2025'],
                    datasets: [{
                        label: 'Sustainability Score',
                        data: [45, 48.5, 52, 56.5, 61, 65.5],
                        borderColor: '#50589C',
                        backgroundColor: 'rgba(80, 88, 156, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '5-Year Sustainability Progress'
                        }
                    }
                }
            });

            // Environment Trend Chart
            const environmentCtx = document.getElementById('environmentTrendChart').getContext('2d');
            new Chart(environmentCtx, {
                type: 'bar',
                data: {
                    labels: ['2020', '2021', '2022', '2023', '2024', '2025'],
                    datasets: [
                        {
                            label: 'Pollution Index',
                            data: [7.6, 7.2, 6.8, 6.3, 5.9, 5.5],
                            backgroundColor: '#E74C3C'
                        },
                        {
                            label: 'Green Cover %',
                            data: [18, 20, 23, 26, 29, 32],
                            backgroundColor: '#27AE60'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Environmental Metrics Improvement'
                        }
                    }
                }
            });

            // Problem Career Graph
            const careerCtx = document.getElementById('problemCareerChart').getContext('2d');
            new Chart(careerCtx, {
                type: 'line',
                data: {
                    labels: ['Now', '3 Months', '6 Months', '1 Year', '2 Years'],
                    datasets: [
                        {
                            label: 'Health Impacts',
                            data: [65, 72, 78, 85, 92],
                            borderColor: '#E74C3C',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Economic Costs',
                            data: [45, 55, 65, 75, 88],
                            borderColor: '#F39C12',
                            backgroundColor: 'rgba(243, 156, 18, 0.1)',
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Infrastructure Stress',
                            data: [50, 60, 70, 82, 90],
                            borderColor: '#3498DB',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            tension: 0.4,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Problem Escalation Projection'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Impact Severity (%)'
                            }
                        }
                    }
                }
            });

            // Auto-show critical alerts
            {% if critical_issues %}
            setTimeout(() => {
                const criticalAlert = document.querySelector('.critical-alert');
                if (criticalAlert) {
                    criticalAlert.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 1000);
            {% endif %}
        });
    </script>
</body>
</html>